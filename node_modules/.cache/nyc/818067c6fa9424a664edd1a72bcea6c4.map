{"version":3,"sources":["verify_token_middleware.js"],"names":["verifyToken","req","res","next","user","body","token","undefined","sendStatus","err"],"mappings":";;;;;;AAAA;;AAEA,SAASA,WAAT,CAAqBC,GAArB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqC;AACnC,MAAI;AACF,QAAMC,OAAO,0BAAOH,IAAII,IAAJ,CAASC,KAAhB,EAAuB,QAAvB,CAAb;AACA,QAAIF,SAASG,SAAb,EAAwB;AACtBJ;AACD,KAFD,MAEO;AACLD,UAAIM,UAAJ,CAAe,GAAf;AACD;AACF,GAPD,CAOE,OAAOC,GAAP,EAAY;AACZP,QAAIM,UAAJ,CAAe,GAAf;AACD;AACF;;kBAEcR,W","file":"verify_token_middleware.js","sourceRoot":"/home/dev/auth-module/src/common","sourcesContent":["import { verify } from 'jsonwebtoken';\n\nfunction verifyToken(req, res, next) {\n  try {\n    const user = verify(req.body.token, 'unhsiv');\n    if (user !== undefined) {\n      next();\n    } else {\n      res.sendStatus(401);\n    }\n  } catch (err) {\n    res.sendStatus(401);\n  }\n}\n\nexport default verifyToken;\n"]}